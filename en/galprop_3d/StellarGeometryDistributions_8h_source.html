<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>galprop_3d: GALPROP-56.0.2870-Source/source/StellarGeometryDistributions.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">galprop_3d
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">The 3d modified version of galprop</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7a98c93371e2b6917ef699fe15cf46a3.html">GALPROP-56.0.2870-Source</a></li><li class="navelem"><a class="el" href="dir_6ef9142185115690fe51fed7c1a14a76.html">source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">StellarGeometryDistributions.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="StellarGeometryDistributions_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _utl_Distributions_h_</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define _utl_Distributions_h_</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;PhysicalConstants.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ArmData_8h.html">ArmData.h</a>&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="namespaceutl.html">    9</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceutl.html">utl</a> {</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="classutl_1_1ArmFunction.html">   12</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classutl_1_1ArmFunction.html">ArmFunction</a> {</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="classutl_1_1ArmFunction.html#acfa2cd377ac3c71a4ec4a747581299fd">   15</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classutl_1_1ArmFunction.html#acfa2cd377ac3c71a4ec4a747581299fd">~ArmFunction</a>() {}</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keyword">virtual</span> T <a class="code" href="classutl_1_1ArmFunction.html#aa4cc1714509261f5d6b16d3bfe89dd27">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> phi, </div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;             <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> armScale = 1.) = 0;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  };</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="classutl_1_1ExponentialArmFunction.html">   26</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classutl_1_1ExponentialArmFunction.html">ExponentialArmFunction</a> : <span class="keyword">public</span> <a class="code" href="classutl_1_1ArmFunction.html">ArmFunction</a>&lt;double&gt; {</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    </div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classutl_1_1ExponentialArmFunction.html#a1aa0b1e01aa03af0b07652f15fd74168">   30</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classutl_1_1ExponentialArmFunction.html#a1aa0b1e01aa03af0b07652f15fd74168">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> phi, </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;              <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> armScale = 1.) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordtype">double</span> result = 0;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">if</span> (r &gt;= arm.<a class="code" href="classrf_1_1ArmData.html#afecdc17872368edb8d3976f5c4f5cc1e">fRMin</a> &amp;&amp; r &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#ac72402fecb3858e3bf6f1a30f9c8a377">fRMax</a>) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> armPhi = arm.<a class="code" href="classrf_1_1ArmData.html#aa2a1766aab95e18636b0943001572c12">Angle</a>(r);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">if</span> (armPhi &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a4622f03881b9f87f75390d8faeb7e9a3">fPhiMin</a> + arm.<a class="code" href="classrf_1_1ArmData.html#ad23f30ff0687b9f3d48f65cd810d9671">fPhiExtent</a>) {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi), </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        armX = r*cos(armPhi), armY = r*sin(armPhi), </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        dX = armX - x, dY = armY - y, s = sqrt(dX*dX + dY*dY),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        armSigma = 0.5*arm.<a class="code" href="classrf_1_1ArmData.html#a006bc848d27905ff1133ae2f35a2263a">fWidth</a>*armScale;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      result = exp(-s/armSigma)*exp(-(r - rSun)/rScale - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  };</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classutl_1_1WainscoatArmFunction.html">   66</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classutl_1_1WainscoatArmFunction.html">WainscoatArmFunction</a> : <span class="keyword">public</span> <a class="code" href="classutl_1_1ArmFunction.html">ArmFunction</a>&lt;double&gt; {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classutl_1_1WainscoatArmFunction.html#ab4fe7ef6c11f1a5052de72dc0d90433d">   70</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classutl_1_1WainscoatArmFunction.html#ab4fe7ef6c11f1a5052de72dc0d90433d">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> phi, </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;              <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> armScale = 1.) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordtype">double</span> result = 0;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> (r &gt;= arm.<a class="code" href="classrf_1_1ArmData.html#afecdc17872368edb8d3976f5c4f5cc1e">fRMin</a> &amp;&amp; r &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#ac72402fecb3858e3bf6f1a30f9c8a377">fRMax</a>) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">double</span> armPhi = arm.<a class="code" href="classrf_1_1ArmData.html#aa2a1766aab95e18636b0943001572c12">Angle</a>(r);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (armPhi &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a4622f03881b9f87f75390d8faeb7e9a3">fPhiMin</a> + arm.<a class="code" href="classrf_1_1ArmData.html#ad23f30ff0687b9f3d48f65cd810d9671">fPhiExtent</a>) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      armPhi += kPi;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi), </div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        armX = r*cos(armPhi), armY = r*sin(armPhi), </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        dX = armX - x, dY = armY - y, s = sqrt(dX*dX + dY*dY);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      result = </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        (s &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a006bc848d27905ff1133ae2f35a2263a">fWidth</a> ? exp(-(r - rSun)/rScale - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale) : 0.);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  };</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classutl_1_1NE2001ArmFunction.html">  108</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classutl_1_1NE2001ArmFunction.html">NE2001ArmFunction</a> : <span class="keyword">public</span> <a class="code" href="classutl_1_1ArmFunction.html">ArmFunction</a>&lt;double&gt; {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    </div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classutl_1_1NE2001ArmFunction.html#afdf4fccf14ae8a97370de23cdbe9db72">  112</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classutl_1_1NE2001ArmFunction.html#afdf4fccf14ae8a97370de23cdbe9db72">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> phi, </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;              <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">double</span> armScale = 1.) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordtype">double</span> result = 0;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (r &gt;= arm.<a class="code" href="classrf_1_1ArmData.html#afecdc17872368edb8d3976f5c4f5cc1e">fRMin</a> &amp;&amp; r &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#ac72402fecb3858e3bf6f1a30f9c8a377">fRMax</a>) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">double</span> armPhi = arm.<a class="code" href="classrf_1_1ArmData.html#aa2a1766aab95e18636b0943001572c12">Angle</a>(r);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (armPhi &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a4622f03881b9f87f75390d8faeb7e9a3">fPhiMin</a> + arm.<a class="code" href="classrf_1_1ArmData.html#ad23f30ff0687b9f3d48f65cd810d9671">fPhiExtent</a>) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">//armPhi += kPi;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi), </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        armX = r*cos(armPhi), armY = r*sin(armPhi), </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        dX = armX - x, dY = armY - y, s = sqrt(dX*dX + dY*dY),</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        armSigma = arm.<a class="code" href="classrf_1_1ArmData.html#a006bc848d27905ff1133ae2f35a2263a">fWidth</a>*armScale;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> sech2R = (r &gt; 11.5 ? pow(0.5/cosh(r - 11.5), 2.) : 1.);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> sech2Z = pow(1./cosh(z/(0.25*zScale)), 2.);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      </div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      result = exp(-pow(s/armSigma, 2.))*sech2R*sech2Z;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      </div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  };</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="namespaceutl.html#ab620f225d64012c5daa635aa5c9f63ed">  153</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#ab620f225d64012c5daa635aa5c9f63ed">ExpDiscWithHole</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> rScale, </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> rCut, </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> rSun, </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> z, </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> rHole,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> holeIndex) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> expFact = exp(-(r - rSun)/rScale - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale);<span class="comment">//(r &lt;= rCut ? rScale : 0.5) - </span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">//fabs(z)/zScale);</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> expFact*(1. - exp(-pow(r/rHole, holeIndex)));</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="namespaceutl.html#a8bd2892fcd534ce298917519008913ad">  171</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a8bd2892fcd534ce298917519008913ad">ExpDiscWithHoleComposite</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> rCut,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> rHole,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> holeIndex) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> expFact = exp(-(r - rSun)/(r &lt;= rCut ? rScale : 0.5));</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">return</span> expFact*(1. - exp(-pow(r/rHole, holeIndex)))/</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      pow(cosh(-<a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale), 2.);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="namespaceutl.html#a6fbfbbe01af501462197cea8b0ecbd64">  189</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a6fbfbbe01af501462197cea8b0ecbd64">ExpDisc</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> rCut,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> zScale) {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span> (r &lt;= rCut ? exp(-(r - rSun)/rScale - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale) : 0);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="namespaceutl.html#aff0936cca04f2686dbe3d02a45a6ef42">  202</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#aff0936cca04f2686dbe3d02a45a6ef42">WainscoatBulge</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> rMin,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> r1,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> k1) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> rs = (r &lt; rMin ? rMin : r), zs = k1*z,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      x = sqrt(rs*rs + zs*zs)/r1;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> exp(-x*x*x)/pow(x, 1.8);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="namespaceutl.html#a6a130f7906a0a82dde5c07dc46b11505">  217</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a6a130f7906a0a82dde5c07dc46b11505">WainscoatHalo</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> rE,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> zE) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> zp = zE*z;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = sqrt(r*r + zp*zp)/rE;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> pow(10., -3.3307*(pow(alpha, 0.25) - 1.));</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="namespaceutl.html#a085ade294de1d2482a829671c7dc093e">  232</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a085ade294de1d2482a829671c7dc093e">SDSSHalo</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span> rSun, </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> z, <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> qH) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> zOnQH = z/qH, rp = (r &lt; 0.1 ? 0.1 : r);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> pow(rSun/sqrt(rp*rp + zOnQH*zOnQH), alpha);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="namespaceutl.html#aa51921cfd10dd39cbce5a2c3a0317fbf">  244</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#aa51921cfd10dd39cbce5a2c3a0317fbf">WainscoatRing</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> rRing,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> rSigma,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> zScale) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> r0 = rRing*rSun, rS = 0.15*rSun;<span class="comment">//2.0*rSigma*rSun;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> exp(-pow((r - r0)/rS, 2.) - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="namespaceutl.html#a447c642434edd29153742c3dc4f0803f">  259</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a447c642434edd29153742c3dc4f0803f">LopezCorredoiraBulge</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r, </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> phi,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> phiOffset,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> k,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> scaleLength,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> a,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> b,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> index) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// Rotate coordinates into &#39;bulge&#39; frame</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi),</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      cosPhiOffset = cos(phiOffset), sinPhiOffset = sin(phiOffset), </div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      xp = cosPhiOffset*x + sinPhiOffset*y, </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      yp = -sinPhiOffset*x + cosPhiOffset*y;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> xpIndex = pow(xp, index), ypIndex = pow(yp/a, index), </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      zpIndex = pow(z/b, index);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> t = pow(xpIndex + ypIndex + zpIndex, 1./index);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">return</span> k*exp(-t/scaleLength);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="namespaceutl.html#a7a8b8e7a532c2682801b152490598e6c">  287</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a7a8b8e7a532c2682801b152490598e6c">LopezCorredoiraBulgeAverage</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> phiOffset,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> k,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> scaleLength,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> a,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> b,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> index,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span> dPhi) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> phiSteps = int(utl::kPi/dPhi) + 1;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">double</span> result = 0;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; phiSteps; ++i) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> phi = i*dPhi;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      result += <a class="code" href="namespaceutl.html#a447c642434edd29153742c3dc4f0803f">LopezCorredoiraBulge</a>(r, phi, z, phiOffset, k, scaleLength, a, b, index);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">//const double xpIndex = pow(r, 4.0), ypIndex = pow(0/0.49, 4.0), </span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">//zpIndex = pow(z/0.37, 4.0);</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">//const double t = pow(xpIndex + ypIndex + zpIndex, 1.0/4.0);</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">//cout &lt;&lt; r &lt;&lt; &quot; &quot; &lt;&lt; phiSteps &lt;&lt; &quot; &quot; &lt;&lt; result &lt;&lt; &quot; &quot; &lt;&lt; result/phiSteps &lt;&lt; endl;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> result/phiSteps;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// This should more properly be referred to as a form for a triaxial bulge</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// c.f. the L-C boxy bulge above</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="namespaceutl.html#acf529bbb193dd0d5432886968ea0a6ae">  325</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#acf529bbb193dd0d5432886968ea0a6ae">FreudenreichBar</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barX,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barY,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barPerp,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barREnd,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> phi,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barZ,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barPara,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> barHEnd, </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> phiOffset) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// Rotate current x and y into bar frame</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> cosPhiOffset = cos(phiOffset), sinPhiOffset = sin(phiOffset);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> xp = cosPhiOffset*x + sinPhiOffset*y;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> yp = -sinPhiOffset*x + cosPhiOffset*y;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> rPerp = pow(pow(<a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(xp)/barX, barPerp) + </div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                 pow(<a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(yp)/barY, barPerp), 1./barPerp),</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      rs = pow(pow(rPerp, barPara) + pow(<a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/barZ, barPara), 1./barPara);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">return</span> (r &lt;= barREnd ? 1. : exp(-pow((rs - barREnd)/barHEnd, 2.)))/</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      pow(cosh(rs), 2.);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="namespaceutl.html#a182d67eac00582c2deaabf373e4c6e6d">  357</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a182d67eac00582c2deaabf373e4c6e6d">FreudenreichBarAverage</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barX,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barY,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barPerp,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barREnd,</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barZ,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barPara,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> barHEnd,</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">double</span> dPhi) {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> phiSteps = int(utl::kPi/dPhi) + 1;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">double</span> result = 0.0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; phiSteps; ++i) {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> phi = i*dPhi;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      result += <a class="code" href="namespaceutl.html#acf529bbb193dd0d5432886968ea0a6ae">FreudenreichBar</a>(r, barX, barY, barPerp, barREnd, </div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                phi, z, barZ, barPara, barHEnd, 0.0);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">//const double xpIndex = pow(r, 4.0), ypIndex = pow(0/0.49, 4.0), </span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//zpIndex = pow(z/0.37, 4.0);</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//const double t = pow(xpIndex + ypIndex + zpIndex, 1.0/4.0);</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">//cout &lt;&lt; r &lt;&lt; &quot; &quot; &lt;&lt; phiSteps &lt;&lt; &quot; &quot; &lt;&lt; result &lt;&lt; &quot; &quot; &lt;&lt; result/phiSteps &lt;&lt; endl;</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span> result/phiSteps;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="namespaceutl.html#a8c5b7579a1236529a20a25bb08e96dbd">  394</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#a8c5b7579a1236529a20a25bb08e96dbd">WainscoatArm</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> phi, </div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">double</span> result = 0;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (r &gt;= arm.<a class="code" href="classrf_1_1ArmData.html#afecdc17872368edb8d3976f5c4f5cc1e">fRMin</a> &amp;&amp; r &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#ac72402fecb3858e3bf6f1a30f9c8a377">fRMax</a>) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordtype">double</span> armPhi = arm.<a class="code" href="classrf_1_1ArmData.html#aa2a1766aab95e18636b0943001572c12">Angle</a>(r);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">if</span> (armPhi &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a4622f03881b9f87f75390d8faeb7e9a3">fPhiMin</a> + arm.<a class="code" href="classrf_1_1ArmData.html#ad23f30ff0687b9f3d48f65cd810d9671">fPhiExtent</a>) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    </div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    armPhi += kPi;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi), </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      armX = r*cos(armPhi), armY = r*sin(armPhi), </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      dX = armX - x, dY = armY - y, s = sqrt(dX*dX + dY*dY);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    result = </div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      (s &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a006bc848d27905ff1133ae2f35a2263a">fWidth</a> ? exp(-(r - rSun)/rScale - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale) : 0.);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="namespaceutl.html#aca622a2a6793ebf3ea8d26c34f884cac">  429</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#aca622a2a6793ebf3ea8d26c34f884cac">ExponentialArm</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> phi, </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                   <span class="keywordtype">double</span> armScale = 1.) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">double</span> result = 0;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (r &gt;= arm.<a class="code" href="classrf_1_1ArmData.html#afecdc17872368edb8d3976f5c4f5cc1e">fRMin</a> &amp;&amp; r &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#ac72402fecb3858e3bf6f1a30f9c8a377">fRMax</a>) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> armPhi = arm.<a class="code" href="classrf_1_1ArmData.html#aa2a1766aab95e18636b0943001572c12">Angle</a>(r);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">if</span> (armPhi &lt;= arm.<a class="code" href="classrf_1_1ArmData.html#a4622f03881b9f87f75390d8faeb7e9a3">fPhiMin</a> + arm.<a class="code" href="classrf_1_1ArmData.html#ad23f30ff0687b9f3d48f65cd810d9671">fPhiExtent</a>) {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> x = r*cos(phi), y = r*sin(phi), </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      armX = r*cos(armPhi), armY = r*sin(armPhi), </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      dX = armX - x, dY = armY - y, s = sqrt(dX*dX + dY*dY),</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      armSigma = 0.5*arm.<a class="code" href="classrf_1_1ArmData.html#a006bc848d27905ff1133ae2f35a2263a">fWidth</a>/kSqrtTwo/kLogTwo*armScale;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    result = exp(-s/armSigma) <span class="comment">//exp(-0.5*pow(s/(kSqrtTwo*armSigma), 2.))</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      *exp(-(r - rSun)/rScale - <a class="code" href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">fabs</a>(z)/zScale);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="namespaceutl.html#ae1a654888b270e3d2ee8e0395e255374">  464</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#ae1a654888b270e3d2ee8e0395e255374">WainscoatArmAverage</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span> dPhi) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> phiSteps = int(utl::kTwoPi/dPhi) + 1;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">double</span> result = 0.0;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; phiSteps; ++i) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> phi = i*dPhi;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      result += <a class="code" href="namespaceutl.html#a8c5b7579a1236529a20a25bb08e96dbd">WainscoatArm</a>(r, rScale, rSun, phi, z, zScale, arm);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span> result/phiSteps;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    </div><div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="namespaceutl.html#aa76b7ca84a6ae7d6124e7cacd4719d4c">  488</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="namespaceutl.html#aa76b7ca84a6ae7d6124e7cacd4719d4c">ExponentialArmAverage</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> rScale,</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> rSun,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> z,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> zScale,</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classrf_1_1ArmData.html">rf::ArmData</a>&amp; arm,</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> dPhi, </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                      <span class="keywordtype">double</span> armScale = 1.) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> phiSteps = int(utl::kTwoPi/dPhi) + 1;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">double</span> result = 0.0;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; phiSteps; ++i) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> phi = i*dPhi;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      result += <a class="code" href="namespaceutl.html#aca622a2a6793ebf3ea8d26c34f884cac">ExponentialArm</a>(r, rScale, rSun, phi, z, zScale, arm);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> result/phiSteps;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classrf_1_1ArmData_html_aa2a1766aab95e18636b0943001572c12"><div class="ttname"><a href="classrf_1_1ArmData.html#aa2a1766aab95e18636b0943001572c12">rf::ArmData::Angle</a></div><div class="ttdeci">const double Angle(const double r) const</div><div class="ttdef"><b>Definition:</b> ArmData.h:27</div></div>
<div class="ttc" id="classutl_1_1WainscoatArmFunction_html"><div class="ttname"><a href="classutl_1_1WainscoatArmFunction.html">utl::WainscoatArmFunction</a></div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:66</div></div>
<div class="ttc" id="namespaceutl_html_a085ade294de1d2482a829671c7dc093e"><div class="ttname"><a href="namespaceutl.html#a085ade294de1d2482a829671c7dc093e">utl::SDSSHalo</a></div><div class="ttdeci">static double SDSSHalo(const double r, const double rSun, const double z, const double alpha, const double qH)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:232</div></div>
<div class="ttc" id="namespaceutl_html_ae1a654888b270e3d2ee8e0395e255374"><div class="ttname"><a href="namespaceutl.html#ae1a654888b270e3d2ee8e0395e255374">utl::WainscoatArmAverage</a></div><div class="ttdeci">static double WainscoatArmAverage(const double r, const double rScale, const double rSun, const double z, const double zScale, const rf::ArmData &amp;arm, const double dPhi)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:464</div></div>
<div class="ttc" id="classutl_1_1ExponentialArmFunction_html"><div class="ttname"><a href="classutl_1_1ExponentialArmFunction.html">utl::ExponentialArmFunction</a></div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:26</div></div>
<div class="ttc" id="namespaceutl_html_a6fbfbbe01af501462197cea8b0ecbd64"><div class="ttname"><a href="namespaceutl.html#a6fbfbbe01af501462197cea8b0ecbd64">utl::ExpDisc</a></div><div class="ttdeci">static double ExpDisc(const double r, const double rScale, const double rCut, const double rSun, const double z, const double zScale)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:189</div></div>
<div class="ttc" id="namespaceutl_html_acf529bbb193dd0d5432886968ea0a6ae"><div class="ttname"><a href="namespaceutl.html#acf529bbb193dd0d5432886968ea0a6ae">utl::FreudenreichBar</a></div><div class="ttdeci">static double FreudenreichBar(const double r, const double barX, const double barY, const double barPerp, const double barREnd, const double phi, const double z, const double barZ, const double barPara, const double barHEnd, const double phiOffset)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:325</div></div>
<div class="ttc" id="ArmData_8h_html"><div class="ttname"><a href="ArmData_8h.html">ArmData.h</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="namespaceutl_html_aa76b7ca84a6ae7d6124e7cacd4719d4c"><div class="ttname"><a href="namespaceutl.html#aa76b7ca84a6ae7d6124e7cacd4719d4c">utl::ExponentialArmAverage</a></div><div class="ttdeci">static double ExponentialArmAverage(const double r, const double rScale, const double rSun, const double z, const double zScale, const rf::ArmData &amp;arm, const double dPhi, double armScale=1.)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:488</div></div>
<div class="ttc" id="namespaceutl_html_a182d67eac00582c2deaabf373e4c6e6d"><div class="ttname"><a href="namespaceutl.html#a182d67eac00582c2deaabf373e4c6e6d">utl::FreudenreichBarAverage</a></div><div class="ttdeci">static double FreudenreichBarAverage(const double r, const double barX, const double barY, const double barPerp, const double barREnd, const double z, const double barZ, const double barPara, const double barHEnd, const double dPhi)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:357</div></div>
<div class="ttc" id="namespaceutl_html_aff0936cca04f2686dbe3d02a45a6ef42"><div class="ttname"><a href="namespaceutl.html#aff0936cca04f2686dbe3d02a45a6ef42">utl::WainscoatBulge</a></div><div class="ttdeci">static double WainscoatBulge(const double r, const double rMin, const double r1, const double z, const double k1)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:202</div></div>
<div class="ttc" id="namespaceutl_html_a7a8b8e7a532c2682801b152490598e6c"><div class="ttname"><a href="namespaceutl.html#a7a8b8e7a532c2682801b152490598e6c">utl::LopezCorredoiraBulgeAverage</a></div><div class="ttdeci">static double LopezCorredoiraBulgeAverage(const double r, const double z, const double phiOffset, const double k, const double scaleLength, const double a, const double b, const double index, const double dPhi)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:287</div></div>
<div class="ttc" id="classrf_1_1ArmData_html"><div class="ttname"><a href="classrf_1_1ArmData.html">rf::ArmData</a></div><div class="ttdef"><b>Definition:</b> ArmData.h:8</div></div>
<div class="ttc" id="namespaceinteg_html_a8321b537a94df2729ca9f0245d90c0ba"><div class="ttname"><a href="namespaceinteg.html#a8321b537a94df2729ca9f0245d90c0ba">integ::fabs</a></div><div class="ttdeci">double fabs(const double value)</div><div class="ttdef"><b>Definition:</b> integ.h:29</div></div>
<div class="ttc" id="namespaceutl_html_aca622a2a6793ebf3ea8d26c34f884cac"><div class="ttname"><a href="namespaceutl.html#aca622a2a6793ebf3ea8d26c34f884cac">utl::ExponentialArm</a></div><div class="ttdeci">static double ExponentialArm(const double r, const double rScale, const double rSun, const double phi, const double z, const double zScale, const rf::ArmData &amp;arm, double armScale=1.)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:429</div></div>
<div class="ttc" id="classrf_1_1ArmData_html_a006bc848d27905ff1133ae2f35a2263a"><div class="ttname"><a href="classrf_1_1ArmData.html#a006bc848d27905ff1133ae2f35a2263a">rf::ArmData::fWidth</a></div><div class="ttdeci">double fWidth</div><div class="ttdef"><b>Definition:</b> ArmData.h:23</div></div>
<div class="ttc" id="classutl_1_1NE2001ArmFunction_html"><div class="ttname"><a href="classutl_1_1NE2001ArmFunction.html">utl::NE2001ArmFunction</a></div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:108</div></div>
<div class="ttc" id="classrf_1_1ArmData_html_ac72402fecb3858e3bf6f1a30f9c8a377"><div class="ttname"><a href="classrf_1_1ArmData.html#ac72402fecb3858e3bf6f1a30f9c8a377">rf::ArmData::fRMax</a></div><div class="ttdeci">double fRMax</div><div class="ttdef"><b>Definition:</b> ArmData.h:23</div></div>
<div class="ttc" id="namespaceutl_html"><div class="ttname"><a href="namespaceutl.html">utl</a></div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:9</div></div>
<div class="ttc" id="classutl_1_1ArmFunction_html"><div class="ttname"><a href="classutl_1_1ArmFunction.html">utl::ArmFunction</a></div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:12</div></div>
<div class="ttc" id="namespaceutl_html_a8c5b7579a1236529a20a25bb08e96dbd"><div class="ttname"><a href="namespaceutl.html#a8c5b7579a1236529a20a25bb08e96dbd">utl::WainscoatArm</a></div><div class="ttdeci">static double WainscoatArm(const double r, const double rScale, const double rSun, const double phi, const double z, const double zScale, const rf::ArmData &amp;arm)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:394</div></div>
<div class="ttc" id="classutl_1_1NE2001ArmFunction_html_afdf4fccf14ae8a97370de23cdbe9db72"><div class="ttname"><a href="classutl_1_1NE2001ArmFunction.html#afdf4fccf14ae8a97370de23cdbe9db72">utl::NE2001ArmFunction::operator()</a></div><div class="ttdeci">double operator()(const double r, const double rScale, const double rSun, const double phi, const double z, const double zScale, const rf::ArmData &amp;arm, const double armScale=1.)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:112</div></div>
<div class="ttc" id="namespaceutl_html_ab620f225d64012c5daa635aa5c9f63ed"><div class="ttname"><a href="namespaceutl.html#ab620f225d64012c5daa635aa5c9f63ed">utl::ExpDiscWithHole</a></div><div class="ttdeci">static double ExpDiscWithHole(const double r, const double rScale, const double rCut, const double rSun, const double z, const double zScale, const double rHole, const double holeIndex)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:153</div></div>
<div class="ttc" id="namespaceutl_html_aa51921cfd10dd39cbce5a2c3a0317fbf"><div class="ttname"><a href="namespaceutl.html#aa51921cfd10dd39cbce5a2c3a0317fbf">utl::WainscoatRing</a></div><div class="ttdeci">static double WainscoatRing(const double r, const double rRing, const double rSigma, const double rSun, const double z, const double zScale)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:244</div></div>
<div class="ttc" id="classutl_1_1ExponentialArmFunction_html_a1aa0b1e01aa03af0b07652f15fd74168"><div class="ttname"><a href="classutl_1_1ExponentialArmFunction.html#a1aa0b1e01aa03af0b07652f15fd74168">utl::ExponentialArmFunction::operator()</a></div><div class="ttdeci">double operator()(const double r, const double rScale, const double rSun, const double phi, const double z, const double zScale, const rf::ArmData &amp;arm, const double armScale=1.)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:30</div></div>
<div class="ttc" id="namespaceutl_html_a8bd2892fcd534ce298917519008913ad"><div class="ttname"><a href="namespaceutl.html#a8bd2892fcd534ce298917519008913ad">utl::ExpDiscWithHoleComposite</a></div><div class="ttdeci">static double ExpDiscWithHoleComposite(const double r, const double rScale, const double rCut, const double rSun, const double z, const double zScale, const double rHole, const double holeIndex)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:171</div></div>
<div class="ttc" id="classrf_1_1ArmData_html_a4622f03881b9f87f75390d8faeb7e9a3"><div class="ttname"><a href="classrf_1_1ArmData.html#a4622f03881b9f87f75390d8faeb7e9a3">rf::ArmData::fPhiMin</a></div><div class="ttdeci">double fPhiMin</div><div class="ttdef"><b>Definition:</b> ArmData.h:23</div></div>
<div class="ttc" id="classrf_1_1ArmData_html_ad23f30ff0687b9f3d48f65cd810d9671"><div class="ttname"><a href="classrf_1_1ArmData.html#ad23f30ff0687b9f3d48f65cd810d9671">rf::ArmData::fPhiExtent</a></div><div class="ttdeci">double fPhiExtent</div><div class="ttdef"><b>Definition:</b> ArmData.h:23</div></div>
<div class="ttc" id="classutl_1_1ArmFunction_html_acfa2cd377ac3c71a4ec4a747581299fd"><div class="ttname"><a href="classutl_1_1ArmFunction.html#acfa2cd377ac3c71a4ec4a747581299fd">utl::ArmFunction::~ArmFunction</a></div><div class="ttdeci">virtual ~ArmFunction()</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:15</div></div>
<div class="ttc" id="namespaceutl_html_a447c642434edd29153742c3dc4f0803f"><div class="ttname"><a href="namespaceutl.html#a447c642434edd29153742c3dc4f0803f">utl::LopezCorredoiraBulge</a></div><div class="ttdeci">static double LopezCorredoiraBulge(const double r, const double phi, const double z, const double phiOffset, const double k, const double scaleLength, const double a, const double b, const double index)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:259</div></div>
<div class="ttc" id="classutl_1_1WainscoatArmFunction_html_ab4fe7ef6c11f1a5052de72dc0d90433d"><div class="ttname"><a href="classutl_1_1WainscoatArmFunction.html#ab4fe7ef6c11f1a5052de72dc0d90433d">utl::WainscoatArmFunction::operator()</a></div><div class="ttdeci">double operator()(const double r, const double rScale, const double rSun, const double phi, const double z, const double zScale, const rf::ArmData &amp;arm, const double armScale=1.)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:70</div></div>
<div class="ttc" id="classutl_1_1ArmFunction_html_aa4cc1714509261f5d6b16d3bfe89dd27"><div class="ttname"><a href="classutl_1_1ArmFunction.html#aa4cc1714509261f5d6b16d3bfe89dd27">utl::ArmFunction::operator()</a></div><div class="ttdeci">virtual T operator()(const double r, const double rScale, const double rSun, const double phi, const double z, const double zScale, const rf::ArmData &amp;arm, const double armScale=1.)=0</div></div>
<div class="ttc" id="namespaceutl_html_a6a130f7906a0a82dde5c07dc46b11505"><div class="ttname"><a href="namespaceutl.html#a6a130f7906a0a82dde5c07dc46b11505">utl::WainscoatHalo</a></div><div class="ttdeci">static double WainscoatHalo(const double r, const double rE, const double z, const double zE)</div><div class="ttdef"><b>Definition:</b> StellarGeometryDistributions.h:217</div></div>
<div class="ttc" id="classrf_1_1ArmData_html_afecdc17872368edb8d3976f5c4f5cc1e"><div class="ttname"><a href="classrf_1_1ArmData.html#afecdc17872368edb8d3976f5c4f5cc1e">rf::ArmData::fRMin</a></div><div class="ttdeci">double fRMin</div><div class="ttdef"><b>Definition:</b> ArmData.h:23</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
